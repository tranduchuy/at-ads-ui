<div class="container">

  <div class="title1">
    THEO DÕI KHÁCH ĐANG CLICK QUẢNG CÁO - TÀI KHOẢN <span
      style="color: yellow">{{_sessionService.activeAdsAccountId}}</span>
  </div>

  <div class="inner">
    <div class="table-wrapper">

      <mat-table
        [dataSource]="dataSource | paginate: { itemsPerPage: pageLimit, currentPage: currentPageNumber, totalItems: totalItems }"
        class="mat-elevation-z8">

        <ng-container matColumnDef="time">
          <mat-header-cell *matHeaderCellDef> Thời gian </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.info[0].createdAt | date: 'HH:mm dd/MM/yyyy'}} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="ip">
          <mat-header-cell *matHeaderCellDef> IP </mat-header-cell>
          <mat-cell *matCellDef="let element">

            <a matTooltip="Nhấn vào để xem chi tiết" [routerLink]="['/bao-cao/chi-tiet-ip', element._id]"
              style="font-weight: bold; padding-left: 0" mat-button color="accent">
              {{element._id}}
            </a>

            <!-- <a style="font-weight: bold; padding-left: 0" mat-button color="accent">
                  {{element._id}}
                </a> -->

          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="clicks">
          <mat-header-cell *matHeaderCellDef> Lần click </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.click}} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="status">
          <mat-header-cell *matHeaderCellDef> Nhận diện </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <span *ngIf="element.isSpam" style="color: crimson; font-weight: bold">
              <mat-icon style="font-size: 18px">not_interested</mat-icon> Đã chặn
            </span>
            <span *ngIf="!element.isSpam" style="color: #44b543; font-weight: bold">
              <mat-icon style="font-size: 18px">check_circle</mat-icon> Hợp lệ
            </span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="location">
          <mat-header-cell *matHeaderCellDef> Tại (địa điểm) </mat-header-cell>
          <mat-cell *matCellDef="let element">
            {{element.info[0].location?.city ? element.info[0].location?.city : 'Unknown' }} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="os">
          <mat-header-cell *matHeaderCellDef> Hệ điều hành </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <img *ngIf="element.info[0].os?.name === 'Windows'"
              src="https://1000logos.net/wp-content/uploads/2017/06/Windows-Logo.png" alt="" class="icon">
            <img *ngIf="element.info[0].os?.name === 'iOS'"
              src="https://fairphone.cdn.shoprenter.hu/custom/fairphone/image/data/brand%20k%C3%A9pek/PNGPIX-COM-Apple-Grey-Logo-PNG-Transparent-500x576.png?lastmod=1534242773.1525780115"
              alt="" class="icon">
            <img *ngIf="element.info[0].os?.name === 'Android'"
              src="https://image.flaticon.com/icons/png/512/226/226770.png" alt="" class="icon">
            <img *ngIf="element.info[0].os?.name === 'Mac OS'"
              src="https://banner2.kisspng.com/20180415/vae/kisspng-finder-computer-icons-apple-logo-5ad351903f2c75.5613029815237984162588.jpg"
              alt="" class="icon">
            <img *ngIf="element.info[0].os?.name === 'Linux'"
              src="https://1000logos.net/wp-content/uploads/2017/03/LINUX-LOGO.png" alt="" class="icon">
            {{element.info[0].os?.name + ' ' + element.info[0].os?.version}}
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="browser">
          <mat-header-cell *matHeaderCellDef> Trình duyệt </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <img *ngIf="element.info[0].browser?.name === 'Firefox'"
              src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Firefox_Logo%2C_2017.svg/1024px-Firefox_Logo%2C_2017.svg.png"
              alt="" class="icon">
            <img *ngIf="element.info[0].browser?.name === 'Chrome'"
              src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Google_Chrome_icon_%28September_2014%29.svg/1200px-Google_Chrome_icon_%28September_2014%29.svg.png"
              alt="" class="icon">
            <img *ngIf="element.info[0].browser?.name === 'Safari' || element.info[0].browser?.name === 'Mobile Safari'"
              src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Safari_browser_logo.svg/1200px-Safari_browser_logo.svg.png"
              alt="" class="icon">
            <img *ngIf="element.info[0].browser?.name === 'IE'"
              src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Internet_Explorer_10%2B11_logo.svg/1200px-Internet_Explorer_10%2B11_logo.svg.png"
              alt="" class="icon">
            <img *ngIf="element.info[0].browser?.name === 'Cốc Cốc'"
              src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/C%E1%BB%91c_C%E1%BB%91c_logo.svg/1024px-C%E1%BB%91c_C%E1%BB%91c_logo.svg.png"
              alt="" class="icon">
            <img *ngIf="element.info[0].browser?.name === 'Opera'"
              src="https://cdn.freebiesupply.com/logos/large/2x/opera-2-logo-png-transparent.png" alt="" class="icon">
            <img *ngIf="element.info[0].browser?.name === 'Tor'"
              src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/i/2d904534-a747-4e77-b01c-a7a77fe8adb7/d7t716u-49fc2695-680d-4264-b8c0-510f85dd2ebf.png/v1/fill/w_894,h_894,strp/tor_logo_by_stanchenko_d7t716u-pre.png"
              alt="" class="icon">
            {{element.info[0].browser?.name + ' ' + element.info[0].browser?.version}}
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="isPrivateBrowsing">
          <mat-header-cell *matHeaderCellDef> Ẩn danh </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <span *ngIf="element.isPrivateBrowsing" style="color: orange; font-weight: bold">
              <mat-icon style="font-size: 18px">report_problem</mat-icon>Có
            </span>
            <span *ngIf="!element.isPrivateBrowsing" style="color:silver">Không</span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="network">
          <mat-header-cell *matHeaderCellDef> Mạng </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.info[0].networkCompany?.name | uppercase}} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="keyword">
          <mat-header-cell *matHeaderCellDef> Từ khóa </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.info[0].keyword ? element.info[0].keyword : 'Unknown'}}
          </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>

      </mat-table>

    </div>

    <div class="pagination-buttons" fxLayout="row" fxLayout.xs="column" *ngIf="pageTotal !== 1">
      <p *ngIf="pageTotal > 0">Trang <span [(ngModel)]="currentPageNumber"
          ngDefaultControl>{{currentPageNumber === undefined ? 1 : currentPageNumber}}</span> trong tổng
        {{pageTotal}} trang</p>
      <p *ngIf="pageTotal === 0">Chưa có ghi nhận nào.</p>
      <pagination-controls (pageChange)="changePage($event); currentPageNumber = $event" previousLabel="Trước"
        nextLabel="Sau" fxFlex fxLayoutAlign="end start" *ngIf="pageTotal > 0"></pagination-controls>
    </div>

    <mat-divider></mat-divider>

    <div class="footer">
      <p>
        Để thực hiện giới hạn 1 IP click quảng cáo nhiều lần hay gọi là click ảo, Bạn có thể hạn chế bằng <span
          style="color: red; font-weight: bold">Tính Năng Hạn Chế Click Ảo</span>
      </p>
      <div class="button-area" fxLayout="row" fxLayout.xs="column" fxLayoutGap="15px" fxLayoutAlign="center center">
        <!-- <button mat-raised-button color="accent" style="border-radius: 0">
              <mat-icon>verified_user</mat-icon> HẠN CHẾ IP CLICK NHIỀU
            </button> -->
        <a [routerLink]="'/bao-cao/click-ao'" mat-raised-button color="warn" style="border-radius: 0">
          <mat-icon>data_usage</mat-icon> XEM BÁO CÁO THEO NGÀY
        </a>
      </div>
    </div>
  </div>

</div>