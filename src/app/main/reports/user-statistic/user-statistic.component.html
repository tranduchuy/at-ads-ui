<div class="container">

  <div class="title1" fxLayout="row" fxLayout.xs="column">
    <p class="title2" fxFlex="80">BÁO CÁO THỐNG KÊ NGƯỜI DÙNG - TÀI KHOẢN <span
        style="color:yellow">{{_sessionService.activeAdsAccountId}}</span></p>
    <mat-form-field class="datePicker" fxFlex="20">
      <mat-label style="color: white">Khoảng thời gian thống kê</mat-label>
      <input type="text" ngxDaterangepickerMd matInput readonly [locale]="locale" [(ngModel)]="selectedDateRange"
        startKey="start" endKey="end" (datesUpdated)="onApplyDateRange($event)"
        (change)="getStatisticUserReport(selectedAccountId, 1)" ngDefaultControl />
    </mat-form-field>
  </div>

  <div class="inner">
    <div class="mat-elevation-z8 table-wrapper">
      <mat-table
        [dataSource]="dataSource | paginate: { itemsPerPage: pageLimit, currentPage: currentPageNumber, totalItems: totalItems }">

        <ng-container matColumnDef="time">
          <mat-header-cell *matHeaderCellDef> Thời gian </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.createdAt | date: 'HH:mm dd/MM/yyyy'}} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="ip">
          <mat-header-cell *matHeaderCellDef> Người dùng </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <a mat-button color="accent" *ngIf="element._id" class="table-uuid" matTooltip="Nhấn vào để xem chi tiết"
              [routerLink]="['/bao-cao/chi-tiet-thong-ke-nguoi-dung', element.uuid]">
              <img [src]="'https://www.mncplay.id/wp-content/uploads/2016/08/blank-profile.png'"
                class="user-image"> {{element._id}}</a>
            <span style="color: #039be5" *ngIf="!element._id">Không xác định</span>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="clicks">
          <mat-header-cell *matHeaderCellDef> Số lần click </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.count}} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="keyword">
          <mat-header-cell *matHeaderCellDef> Từ khóa </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <mat-cell *matCellDef="let element"> {{element.keyword}} </mat-cell>
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="location">
          <mat-header-cell *matHeaderCellDef> Vị trí </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{element.location?.city}} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="network">
          <mat-header-cell *matHeaderCellDef> Mạng </mat-header-cell>
          <mat-cell *matCellDef="let element">{{element.networkCompany?.name}}</mat-cell>
        </ng-container>

        <!-- <ng-container matColumnDef="device">
              <mat-header-cell *matHeaderCellDef> Thiết bị </mat-header-cell>
              <mat-cell *matCellDef="let element">
                <img src="https://cdn.freebiesupply.com/logos/large/2x/wifi-1-logo-png-transparent.png" alt=""
                  class="device-symbol" *ngIf="element.device === 'Click bằng mạng Wifi'" matTooltip="{{element.device}}">
                <img src="https://peoplepng.com/wp-content/uploads/2019/05/3g-png-4.png" alt="" class="device-symbol"
                  *ngIf="element.device === 'Click bằng mạng 3G'" matTooltip="{{element.device}}">
                <p style="width: 50px; text-align: center">
                  <mat-icon *ngIf="element.device === '80% mạng 3G - 20% mạng Wifi'" color="accent"
                    matTooltip="{{element.device}}">help_outline</mat-icon>
                </p>
              </mat-cell>
            </ng-container> -->

        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
      </mat-table>
    </div>

    <div class="pagination-buttons" fxLayout="row" fxLayout.xs="column" *ngIf="pageTotal !== 1">
      <p *ngIf="pageTotal > 0">Trang <span [(ngModel)]="currentPageNumber"
          ngDefaultControl>{{currentPageNumber === 0 || currentPageNumber === undefined ? 1 : currentPageNumber}}</span>
        trong tổng
        {{pageTotal}} trang</p>
      <p *ngIf="pageTotal === 0">Chưa có ghi nhận nào.</p>
      <pagination-controls (pageChange)="changePage($event); currentPageNumber = $event" previousLabel="Trước"
        nextLabel="Sau" fxFlex fxLayoutAlign="end start" *ngIf="pageTotal > 0"></pagination-controls>
    </div>
  </div>

</div>
