<div class="container">

  <div class="title1"></div>

  <div class="inner">

    <!-- <div class="highline" fxLayout="row" fxLayout.xs="column" fxLayoutGap="80px" fxLayoutGap.xs="20px">

      <div class="left" fxFlex="26">

        <div class="visitor">

          <div class="visitor-title">Ngay bây giờ</div>

          <div class="visitor-number">9</div>

          <div class="visitor-number-note">người dùng đang hoạt động trên trang web</div>

          <div class="device-chart">

            <div class="chart-legend">
              <div style="background:#F44336" class="chart-label"></div><span>Máy tính</span>
              <br>
              <div style="background:#44b543" class="chart-label"></div><span>Điện thoại</span>
              <br>
              <div style="background:#039be5" class="chart-label"></div><span>Máy tính bảng</span>
            </div>

            <ngx-charts-bar-horizontal-stacked [view]="view" [scheme]="colorScheme" [results]="multi"
              [gradient]="gradient" [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend"
              [showXAxisLabel]="showXAxisLabel" [showYAxisLabel]="showYAxisLabel" [xAxisLabel]="xAxisLabel"
              [yAxisLabel]="yAxisLabel" style="max-width: 100%">

              <ng-template #tooltipTemplate let-model="model">
                <pre>{{model.value}}%</pre>
              </ng-template>

            </ngx-charts-bar-horizontal-stacked>

          </div>

        </div>

      </div>

      <div class="right">
        <div class="right-table-title">
          Trang hoạt động hàng đầu
        </div>

        <div class="right-table">

          <mat-table [dataSource]="highlinePages" class="mat-elevation-z8">

            <ng-container matColumnDef="order">
              <mat-header-cell *matHeaderCellDef> # </mat-header-cell>
              <mat-cell *matCellDef="let element; let i = index"> {{i+1}} </mat-cell>
            </ng-container>

            <ng-container matColumnDef="activePage">
              <mat-header-cell *matHeaderCellDef> Trang hoạt động </mat-header-cell>
              <mat-cell *matCellDef="let element"> <a href="{{element.activePage}}">{{element.activePage}}</a>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="userOnAction">
              <mat-header-cell *matHeaderCellDef> Người dùng đang hoạt động <mat-icon
                  style="font-size: 18px; margin-left: 5px">arrow_downward</mat-icon>
              </mat-header-cell>
              <mat-cell *matCellDef="let element" fxLayout="row">
                <div class="user-number" fxFlex="30">
                  {{element.userOnAction.number}}
                </div>
                <div class="user-percentage">
                  {{element.userOnAction.percentage}}%
                </div>
              </mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="highlinePagesCols"></mat-header-row>
            <mat-row *matRowDef="let row; columns: highlinePagesCols;"></mat-row>

          </mat-table>

        </div>

      </div>

    </div> -->

    <div class="highline2">
      <div class="hl2-title1" fxLayout="row" fxLayout.xs="column" fxLayoutAlign="start center">
        <div class="hl2-title3" fxFlex="80">
          THỐNG KÊ LƯU LƯỢNG TRUY CẬP - TÀI KHOẢN <span
            style="color: yellow">{{_sessionService.activeAdsAccountId}}</span>
        </div>
        <mat-form-field class="datePicker">
          <mat-label style="color: white">Khoảng thời gian thống kê</mat-label>
          <input type="text" ngxDaterangepickerMd matInput readonly [locale]="locale" [(ngModel)]="selectedDateRange"
            startKey="start" endKey="end" (datesUpdated)="onSelectDateRange($event)" (change)="onApplyDateRange()"
            ngDefaultControl />
        </mat-form-field>
      </div>

      <div class="hl2-title2">
        Bạn có thể tiết kiệm trong <span style="color: red; font-weight: bold" [(ngModel)]="selectedDateRange"
          ngDefaultControl>{{selectedDateRange.end.diff(selectedDateRange.start, 'days') + 1}} ngày</span>
        từ <span style="color:#039be5; font-weight: bold" [(ngModel)]="selectedDateRange"
          ngDefaultControl>{{selectedDateRange.start | date: 'dd/MM/yyyy'}}</span> đến
        ngày <span style="color: #039be5; font-weight: bold" [(ngModel)]="selectedDateRange"
          ngDefaultControl>{{selectedDateRange.end | date: 'dd/MM/yyyy'}}</span> bằng việc
        hạn chế chiến dịch ảo
      </div>

      <div class="h-300 hl2-pie-chart">

        <ngx-charts-pie-chart *fuseIfOnDom [scheme]="pieChart.scheme" [results]="pieChart.dataSource"
          [explodeSlices]="pieChart.explodeSlices" [labels]="pieChart.labels" [trimLabels]="pieChart.trimLabels"
          [doughnut]="pieChart.doughnut" [gradient]="pieChart.gradient" [labelFormatting]="pieChart.setLabelFormatting"
          [legend]="pieChart.legend" [legendTitle]="''">

          <ng-template #tooltipTemplate let-model="model">
            <p style="color: #fff; text-align: left">
              {{model.name}} <b>({{model.value}}%)</b>
            </p>
          </ng-template>

        </ngx-charts-pie-chart>

      </div>

    </div>

    <div class="overview">

      <div class="overview-title1" fxLayout="row" fxLayout.xs="column">
        <p class="overview-title2" fxFlex="80">BÁO CÁO TỔNG THỂ TRUY CẬP</p>
        <!-- <mat-form-field class="datePicker" fxFlex="20">
          <mat-label style="color: white">Khoảng thời gian thống kê</mat-label>
          <input type="text" ngxDaterangepickerMd matInput readonly [locale]="locale" [(ngModel)]="selectedDateRange"
            startKey="start" endKey="end" (datesUpdated)="onApplyDateRange($event)" ngDefaultControl />
        </mat-form-field> -->
      </div>

      <div class="overview-table">

        <mat-table
          [dataSource]="overviewTable | paginate: { itemsPerPage: pageLimit, currentPage: currentPageNumber, totalItems: totalItems }"
          class="mat-elevation-z8">

          <ng-container matColumnDef="createdAt">
            <mat-header-cell *matHeaderCellDef> Thời gian </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{element.createdAt | date: 'HH:mm dd/MM/yyyy'}} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="ip">
            <mat-header-cell *matHeaderCellDef> IP </mat-header-cell>
            <mat-cell *matCellDef="let element">
              <a matTooltip="Nhấn vào để xem chi tiết" [routerLink]="['/bao-cao/chi-tiet-ip', element.ip]"
                style="font-weight: bold; padding-left: 0" mat-button color="accent">
                <mat-icon *ngIf="element.isSpam === true" style="color: red; margin-right: 5px; font-size: 18px">not_interested
                </mat-icon>
                <mat-icon *ngIf="element.isSpam === false" style="color:silver; margin-right: 5px; font-size: 18px">
                  not_interested
                </mat-icon>
                {{element.ip}}
              </a>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="session">
            <mat-header-cell *matHeaderCellDef> Số phiên </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{element.count || 0}} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="status">
            <mat-header-cell *matHeaderCellDef> Nhận diện </mat-header-cell>
            <mat-cell *matCellDef="let element">
              <span *ngIf="element.isSpam === true" style="color: crimson; font-weight: bold">
                <mat-icon style="font-size: 18px">not_interested</mat-icon> Đã chặn
              </span>
              <span *ngIf="element.isSpam === false" style="color: #44b543; font-weight: bold">
                <mat-icon style="font-size: 18px">check_circle</mat-icon> Hợp lệ
              </span>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="os">
            <mat-header-cell *matHeaderCellDef> Hệ điều hành </mat-header-cell>
            <mat-cell *matCellDef="let element">
              <img *ngIf="element.os?.name === 'Windows'"
                src="https://1000logos.net/wp-content/uploads/2017/06/Windows-Logo.png" alt="" class="icon">
              <img *ngIf="element.os?.name === 'iOS'"
                src="https://fairphone.cdn.shoprenter.hu/custom/fairphone/image/data/brand%20k%C3%A9pek/PNGPIX-COM-Apple-Grey-Logo-PNG-Transparent-500x576.png?lastmod=1534242773.1525780115"
                alt="" class="icon">
              <img *ngIf="element.os?.name === 'Android'" src="https://image.flaticon.com/icons/png/512/226/226770.png"
                alt="" class="icon">
              <img *ngIf="element.os?.name === 'Mac OS'"
                src="https://banner2.kisspng.com/20180415/vae/kisspng-finder-computer-icons-apple-logo-5ad351903f2c75.5613029815237984162588.jpg"
                alt="" class="icon">
              <img *ngIf="element.os?.name === 'Linux'"
                src="https://1000logos.net/wp-content/uploads/2017/03/LINUX-LOGO.png" alt="" class="icon">
              {{element.os?.name || 'Unknown' + ' ' + element.os?.version || ''}}
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="browser">
            <mat-header-cell *matHeaderCellDef> Trình duyệt </mat-header-cell>
            <mat-cell *matCellDef="let element">
              <img *ngIf="element.browser?.name === 'Firefox'"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Firefox_Logo%2C_2017.svg/1024px-Firefox_Logo%2C_2017.svg.png"
                alt="" class="icon">
              <img *ngIf="element.browser?.name === 'Chrome'"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Google_Chrome_icon_%28September_2014%29.svg/1200px-Google_Chrome_icon_%28September_2014%29.svg.png"
                alt="" class="icon">
              <img *ngIf="element.browser?.name === 'Safari' || element.browser?.name === 'Mobile Safari'"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Safari_browser_logo.svg/1200px-Safari_browser_logo.svg.png"
                alt="" class="icon">
              <img *ngIf="element.browser?.name === 'IE'"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Internet_Explorer_10%2B11_logo.svg/1200px-Internet_Explorer_10%2B11_logo.svg.png"
                alt="" class="icon">
              <img *ngIf="element.browser?.name === 'Cốc Cốc'"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/C%E1%BB%91c_C%E1%BB%91c_logo.svg/1024px-C%E1%BB%91c_C%E1%BB%91c_logo.svg.png"
                alt="" class="icon">
              <img *ngIf="element.browser?.name === 'Opera'"
                src="https://cdn.freebiesupply.com/logos/large/2x/opera-2-logo-png-transparent.png" alt="" class="icon">
              <img *ngIf="element.browser?.name === 'Tor'"
                src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/i/2d904534-a747-4e77-b01c-a7a77fe8adb7/d7t716u-49fc2695-680d-4264-b8c0-510f85dd2ebf.png/v1/fill/w_894,h_894,strp/tor_logo_by_stanchenko_d7t716u-pre.png"
                alt="" class="icon">
              {{element.browser?.name || 'Unknown' + ' ' + element.browser?.version || ''}}
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="isPrivateBrowsing">
            <mat-header-cell *matHeaderCellDef> Ẩn danh </mat-header-cell>
            <mat-cell *matCellDef="let element">
              <span *ngIf="element.isPrivateBrowsing" style="color: orange; font-weight: bold">
                <mat-icon style="font-size: 18px">report_problem</mat-icon>Có
              </span>
              <span *ngIf="!element.isPrivateBrowsing" style="color:silver">Không</span>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="networkCompany">
            <mat-header-cell *matHeaderCellDef> Mạng </mat-header-cell>
            <mat-cell *matCellDef="let element">
              {{element.networkCompany?.name || 'Unknown'}} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="keyword">
            <mat-header-cell *matHeaderCellDef> Từ khóa </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{element.keyword}} </mat-cell>
          </ng-container>

          <ng-container matColumnDef="location">
            <mat-header-cell *matHeaderCellDef> Tại (địa điểm) </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{element.location?.city || 'Unknown'}}
            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="overviewTableCols; sticky: true"></mat-header-row>
          <mat-row *matRowDef="let row; columns: overviewTableCols;"></mat-row>

        </mat-table>

      </div>

      <div class="pagination-buttons" fxLayout="row" fxLayout.xs="column" *ngIf="pageTotal !== 1">
        <p *ngIf="pageTotal > 0">Trang <span [(ngModel)]="currentPageNumber"
            ngDefaultControl>{{currentPageNumber === undefined ? 1 : currentPageNumber}}</span> trong tổng
          {{pageTotal}} trang</p>
        <p *ngIf="pageTotal === 0">Chưa có ghi nhận nào.</p>
        <pagination-controls (pageChange)="changePage($event); currentPageNumber = $event" previousLabel="Trước"
          nextLabel="Sau" fxFlex fxLayoutAlign="end start" *ngIf="pageTotal > 0"></pagination-controls>
      </div>

    </div>

  </div>

</div>