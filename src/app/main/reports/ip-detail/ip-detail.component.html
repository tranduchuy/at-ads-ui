<div class="container">

  <div class="title1">
    LỊCH SỬ IP CLICK QUẢNG CÁO - TÀI KHOẢN <span style="color:yellow">{{_sessionService.activeAdsAccountId}}</span>
  </div>

  <div class="main-inner">
    <div class="inner">

      <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="15px">
        <div class="left" fxFlex="25">
          <img src="https://www.mncplay.id/wp-content/uploads/2016/08/blank-profile.png" alt="" class="avatar">
          <p style="color: #039be5; font-weight: bold">IP: {{ip}}</p>
        </div>

        <div class="right">
          <!-- <mat-table
            [dataSource]="history | paginate: { itemsPerPage: pageLimit, currentPage: currentPageNumber, totalItems: totalItems }"
            class="mat-elevation-z8">

            <ng-container matColumnDef="adwords">
              <mat-header-cell *matHeaderCellDef></mat-header-cell>
              <mat-cell *matCellDef="let element">
                <span class="adwords-badge">GOOGLE ADS</span>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="accessTime">
              <mat-header-cell *matHeaderCellDef>Truy cập</mat-header-cell>
              <mat-cell *matCellDef="let element">

                <mat-icon *ngIf="element.isSpam" style="margin-right: 10px; color: crimson"
                  matTooltip="Đã chặn và không bị tính tiền">verified_user</mat-icon>

                <mat-icon *ngIf="!element.isSpam" style="margin-right: 10px; color: gold"
                  matTooltip="Click chuột quảng cáo bị tính tiền">monetization_on</mat-icon>

                {{element.createdAt | date: 'HH:mm dd/MM/yyyy'}}
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="device">
              <mat-header-cell *matHeaderCellDef>Thiết bị</mat-header-cell>
              <mat-cell *matCellDef="let element; let i = index">
                <span *ngIf="element.device === undefined">Unknown</span>
                <span *ngIf="element.device !== undefined">{{element.device?.vendor}}</span>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="os">
              <mat-header-cell *matHeaderCellDef>Hệ điều hành</mat-header-cell>
              <mat-cell *matCellDef="let element">
                <img *ngIf="element.os?.name === 'Windows'"
                  src="https://1000logos.net/wp-content/uploads/2017/06/Windows-Logo.png" alt="" class="icon">
                <img *ngIf="element.os?.name === 'iOS'"
                  src="https://fairphone.cdn.shoprenter.hu/custom/fairphone/image/data/brand%20k%C3%A9pek/PNGPIX-COM-Apple-Grey-Logo-PNG-Transparent-500x576.png?lastmod=1534242773.1525780115"
                  alt="" class="icon">
                <img *ngIf="element.os?.name === 'Android'"
                  src="https://image.flaticon.com/icons/png/512/226/226770.png" alt="" class="icon">
                <img *ngIf="element.os?.name === 'Mac OS'"
                  src="https://banner2.kisspng.com/20180415/vae/kisspng-finder-computer-icons-apple-logo-5ad351903f2c75.5613029815237984162588.jpg"
                  alt="" class="icon">
                <img *ngIf="element.os?.name === 'Linux'"
                  src="https://1000logos.net/wp-content/uploads/2017/03/LINUX-LOGO.png" alt="" class="icon">
                {{element.os?.name + ' ' + element.os?.version}}
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="browser">
              <mat-header-cell *matHeaderCellDef>Trình duyệt</mat-header-cell>
              <mat-cell *matCellDef="let element">
                <img *ngIf="element.browser?.name === 'Firefox'"
                  src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Firefox_Logo%2C_2017.svg/1024px-Firefox_Logo%2C_2017.svg.png"
                  alt="" class="icon">
                <img *ngIf="element.browser?.name === 'Chrome'"
                  src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Google_Chrome_icon_%28September_2014%29.svg/1200px-Google_Chrome_icon_%28September_2014%29.svg.png"
                  alt="" class="icon">
                <img *ngIf="element.browser?.name === 'Safari' || element.browser?.name === 'Mobile Safari'"
                  src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Safari_browser_logo.svg/1200px-Safari_browser_logo.svg.png"
                  alt="" class="icon">
                <img *ngIf="element.browser?.name === 'IE'"
                  src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Internet_Explorer_10%2B11_logo.svg/1200px-Internet_Explorer_10%2B11_logo.svg.png"
                  alt="" class="icon">
                <img *ngIf="element.browser?.name === 'Cốc Cốc'"
                  src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/C%E1%BB%91c_C%E1%BB%91c_logo.svg/1024px-C%E1%BB%91c_C%E1%BB%91c_logo.svg.png"
                  alt="" class="icon">
                <img *ngIf="element.browser?.name === 'Opera'"
                  src="https://cdn.freebiesupply.com/logos/large/2x/opera-2-logo-png-transparent.png" alt=""
                  class="icon">
                <img *ngIf="element.browser?.name === 'Tor'"
                  src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/i/2d904534-a747-4e77-b01c-a7a77fe8adb7/d7t716u-49fc2695-680d-4264-b8c0-510f85dd2ebf.png/v1/fill/w_894,h_894,strp/tor_logo_by_stanchenko_d7t716u-pre.png"
                  alt="" class="icon">
                {{element.browser?.name + ' ' + element.browser?.version}}
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="isPrivateBrowsing">
              <mat-header-cell *matHeaderCellDef>Ẩn danh</mat-header-cell>
              <mat-cell *matCellDef="let element">
                <span *ngIf="!element.isPrivateBrowsing" style="color: orange; font-weight: bold">
                  <mat-icon style="font-size: 18px">report_problem</mat-icon>Có
                </span>
                <span *ngIf="element.isPrivateBrowsing" style="color:silver">Không</span>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="keyword">
              <mat-header-cell *matHeaderCellDef>Từ khóa</mat-header-cell>
              <mat-cell *matCellDef="let element"></mat-cell>
            </ng-container>

            <ng-container matColumnDef="website">
              <mat-header-cell *matHeaderCellDef>Trang truy cập</mat-header-cell>
              <mat-cell *matCellDef="let element">
                <a href="{{element.href}}" target="_blank"><span style="text-decoration: underline">Link tại
                    đây</span></a>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="location">
              <mat-header-cell *matHeaderCellDef>Tại (địa điểm)</mat-header-cell>
              <mat-cell *matCellDef="let element">{{element.location?.city ? element.location?.city : 'Unknown'}}</mat-cell>
            </ng-container>

            <mat-header-row *matHeaderRowDef="historyColumns; sticky: true"></mat-header-row>
            <mat-row *matRowDef="let row; columns: historyColumns"></mat-row>
          </mat-table> -->

          <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
            <!-- This is the tree node template for leaf nodes -->
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
              <li class="mat-tree-node">
                <button mat-icon-button disabled></button>
                <!-- <span style="color: #039be5">{{node.name}}</span> -->
                <ul *ngIf="node.logs !== undefined" class="div-uuid">
                  <li *ngFor="let element of node.logs">
                    <mat-divider style="margin-top: 20px; margin-bottom: 20px"></mat-divider>
                    <p style="color: #039be5">Người dùng {{node.index + 1}}</p>
                    <mat-expansion-panel>
                      <mat-expansion-panel-header>
                        <mat-panel-title style="padding: 10px; font-size: 14px;">
                          Xem chi tiết<span style="margin-left: 5px">vào lúc
                            {{element.createdAt | date: 'HH:mm'}}</span>
                        </mat-panel-title>
                        <!-- <mat-panel-description>
                          Type your name and age
                        </mat-panel-description> -->
                      </mat-expansion-panel-header>
                      <p>Trạng thái:
                        <span *ngIf="element.isSpam" style="color: red; margin-left: 23px">
                          <mat-icon style="font-size: 18px">not_interested
                          </mat-icon>Đã chặn
                        </span>
                        <span *ngIf="!element.isSpam" style="color: #44b543; margin-left: 23px">
                          <mat-icon style="font-size: 18px">check_circle
                          </mat-icon>Hợp lệ
                        </span>
                      </p>
                      <p>Thiết bị:
                        <span *ngIf="element.device === undefined" style="margin-left: 43px">Unknown</span>
                        <span *ngIf="element.device !== undefined"
                          style="margin-left: 43px">{{element.device?.vendor}}</span>
                      </p>
                      <p>Hệ điều hành:
                        <img *ngIf="element.os?.name === 'Windows'"
                          src="https://1000logos.net/wp-content/uploads/2017/06/Windows-Logo.png" alt=""
                          class="os-icon">
                        <img *ngIf="element.os?.name === 'iOS'"
                          src="https://fairphone.cdn.shoprenter.hu/custom/fairphone/image/data/brand%20k%C3%A9pek/PNGPIX-COM-Apple-Grey-Logo-PNG-Transparent-500x576.png?lastmod=1534242773.1525780115"
                          alt="" class="os-icon">
                        <img *ngIf="element.os?.name === 'Android'"
                          src="https://image.flaticon.com/icons/png/512/226/226770.png" alt="" class="os-icon">
                        <img *ngIf="element.os?.name === 'Mac OS'"
                          src="https://banner2.kisspng.com/20180415/vae/kisspng-finder-computer-icons-apple-logo-5ad351903f2c75.5613029815237984162588.jpg"
                          alt="" class="os-icon">
                        <img *ngIf="element.os?.name === 'Linux'"
                          src="https://1000logos.net/wp-content/uploads/2017/03/LINUX-LOGO.png" alt="" class="os-icon">
                        {{element.os?.name + ' ' + element.os?.version}}
                      </p>
                      <p>Trình duyệt:
                        <img *ngIf="element.browser?.name === 'Firefox'"
                          src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Firefox_Logo%2C_2017.svg/1024px-Firefox_Logo%2C_2017.svg.png"
                          alt="" class="icon">
                        <img *ngIf="element.browser?.name === 'Chrome'"
                          src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Google_Chrome_icon_%28September_2014%29.svg/1200px-Google_Chrome_icon_%28September_2014%29.svg.png"
                          alt="" class="icon">
                        <img *ngIf="element.browser?.name === 'Safari' || element.browser?.name === 'Mobile Safari'"
                          src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Safari_browser_logo.svg/1200px-Safari_browser_logo.svg.png"
                          alt="" class="icon">
                        <img *ngIf="element.browser?.name === 'IE'"
                          src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Internet_Explorer_10%2B11_logo.svg/1200px-Internet_Explorer_10%2B11_logo.svg.png"
                          alt="" class="icon">
                        <img *ngIf="element.browser?.name === 'Cốc Cốc'"
                          src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/C%E1%BB%91c_C%E1%BB%91c_logo.svg/1024px-C%E1%BB%91c_C%E1%BB%91c_logo.svg.png"
                          alt="" class="icon">
                        <img *ngIf="element.browser?.name === 'Opera'"
                          src="https://cdn.freebiesupply.com/logos/large/2x/opera-2-logo-png-transparent.png" alt=""
                          class="icon">
                        <img *ngIf="element.browser?.name === 'Tor'"
                          src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/i/2d904534-a747-4e77-b01c-a7a77fe8adb7/d7t716u-49fc2695-680d-4264-b8c0-510f85dd2ebf.png/v1/fill/w_894,h_894,strp/tor_logo_by_stanchenko_d7t716u-pre.png"
                          alt="" class="icon">
                        {{element.browser?.name + ' ' + element.browser?.version}}
                      </p>
                      <p>Mạng:
                        <span style="margin-left: 55px">{{element.networkCompany?.name}}</span>
                      </p>
                      <p>Ẩn danh:
                        <span *ngIf="!element.isPrivateBrowsing" style="color: orange; font-weight: bold">
                          <mat-icon style="font-size: 18px; margin-left: 35px">report_problem</mat-icon>Có
                        </span>
                        <span *ngIf="element.isPrivateBrowsing" style="color:silver">Không</span>
                      </p>
                      <p>Từ khóa:
                        <span style="margin-left: 40px">{{element.keyword}}</span>
                      </p>
                      <p>Trang truy cập:
                        <a href="{{element.href}}" target="_blank" style="margin-left: 5px">Link tại đây</a>
                      </p>
                      <p>Địa điểm:
                        <span style="margin-left: 5px">{{element.location?.city}}</span>
                      </p>
                    </mat-expansion-panel>
                  </li>
                </ul>
              </li>
            </mat-tree-node>
            <!-- This is the tree node template for expandable nodes -->
            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
              <li>
                <div class="mat-tree-node">
                  <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name"
                    (click)="showUUIDs(node)">
                    <mat-icon class="mat-icon-rtl-mirror">
                      {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                    </mat-icon>
                  </button>
                  Click {{node.index + 1}}:<span style="color: gray; margin-left: 5px">{{node.name}}</span>
                </div>
                <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
                  <ng-container matTreeNodeOutlet></ng-container>
                </ul>
              </li>
            </mat-nested-tree-node>
          </mat-tree>


        </div>

      </div>

      <!-- <div fxLayout="row" fxLayoutGap="15px" *ngIf="pageTotal !== 1">
        <div fxFlex="20"></div>
        <div class="pagination-buttons" fxLayout="row" fxLayout.xs="column">
          <div fxFlex="70">
            <p *ngIf="pageTotal > 0">Trang <span [(ngModel)]="currentPageNumber"
                ngDefaultControl>{{currentPageNumber === undefined ? 1 : currentPageNumber}}</span> trong tổng
              {{pageTotal}} trang</p>
            <p *ngIf="pageTotal === 0">Chưa có ghi nhận nào.</p>
          </div>
          <pagination-controls (pageChange)="changePage($event); currentPageNumber = $event" previousLabel="Trước"
            nextLabel="Sau" fxFlex fxLayoutAlign="end start" *ngIf="pageTotal > 0"></pagination-controls>
        </div>
      </div> -->

      <div class="bottom">
        <div class="last-access-notification" fxLayout="row" fxLayoutGap="12px">
          <p class="last-history-icon">
            <mat-icon color="accent">calendar_today</mat-icon>
          </p>
          <p class="title">
            Ngày ghi nhận cuối
            <br>
            <span style="color: gray" *ngIf="dataSource.data.length > 0">
              {{dataSource.data[0].name | date: 'HH:mm dd/MM/yyyy'}}</span>
          </p>
        </div>
        <div class="access-location" fxLayout="row" fxLayoutGap="12px">
          <p class="last-history-icon">
            <mat-icon color="accent">location_on</mat-icon>
          </p>
          <div class="title">
            Vị trí truy cập
            <br>
            <div style="color: gray" *ngIf="dataSource.data.length > 0">
              <span *ngIf="dataSource.data[0].logs.location === undefined">Unknown</span>
              <span
                *ngIf="dataSource.data[0].logs.location !== undefined">{{dataSource.data[0].logs.location?.city}}</span>
            </div>
          </div>
        </div>
        <div class="last-access-device" fxLayout="row" fxLayoutGap="12px">
          <div class="last-history-icon">
            <mat-icon color="accent">speaker_phone</mat-icon>
          </div>
          <div class="title">
            Thiết bị truy cập cuối
            <div style="color: gray" *ngIf="dataSource.data.length > 0">
              <span *ngIf="dataSource.data[0].logs.device === undefined">Unknown</span>
              <span
                *ngIf="dataSource.data[0].logs.device !== undefined">{{dataSource.data[0].logs.device?.vendor}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>